
<div class="admin-dashboard">
  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <div class="error-message">
      <span class="material-icons">error</span>
      <h3>Error Loading Dashboard</h3>
      <p>Unable to load dashboard data. Please try again.</p>
      <button class="retry-btn" (click)="refreshData()">
        <span class="material-icons">refresh</span>
        Retry
      </button>
    </div>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error && dashboardStats" class="dashboard-content">
    <div class="dashboard-header">
      <div class="header-content">
        <h1>Admin Dashboard</h1>
        <p>Welcome to the HRIS Administration Panel</p>
      </div>
      <div class="header-actions">
        <button class="refresh-btn" (click)="refreshData()" title="Refresh Data">
          <span class="material-icons">refresh</span>
        </button>
      </div>
    </div>
    
    <div class="dashboard-grid">
      <div class="dashboard-card">
        <div class="card-icon">
          <span class="material-icons">people</span>
        </div>
        <div class="card-content">
          <h3>Total Employees</h3>
          <p class="card-number">{{ dashboardStats.totalEmployees | number }}</p>
          <p class="card-change positive">+{{ dashboardStats.activeEmployees }} active</p>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-icon">
          <span class="material-icons">schedule</span>
        </div>
        <div class="card-content">
          <h3>Active Attendance</h3>
          <p class="card-number">{{ dashboardStats.attendanceOverview.present | number }}</p>
          <p class="card-change">{{ getAttendancePercentage() }}% attendance rate</p>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-icon">
          <span class="material-icons">event</span>
        </div>
        <div class="card-content">
          <h3>Pending Leave Requests</h3>
          <p class="card-number">{{ dashboardStats.pendingLeaveRequests | number }}</p>
          <p class="card-change negative">Requires approval</p>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-icon">
          <span class="material-icons">payments</span>
        </div>
        <div class="card-content">
          <h3>Payroll Status</h3>
          <p class="card-number">{{ dashboardStats.payrollStatus }}</p>
          <p class="card-change">For processing</p>
        </div>
      </div>
    </div>
    
    <div class="dashboard-sections">
      <div class="section">
        <h2>Quick Actions</h2>
        <div class="action-buttons">
          <button class="action-btn" (click)="navigateToSection('personnel')">
            <span class="material-icons">add</span>
            Add Employee
          </button>
          <button class="action-btn" (click)="navigateToSection('reports')">
            <span class="material-icons">assessment</span>
            Generate Report
          </button>
          <button class="action-btn" (click)="navigateToSection('system')">
            <span class="material-icons">settings</span>
            System Settings
          </button>
          <button class="action-btn" (click)="navigateToSection('leave')">
            <span class="material-icons">event</span>
            Leave Management
          </button>
        </div>
      </div>

      <div class="section">
        <h2>Recent Activities</h2>
        <div class="activities-list">
          <div *ngFor="let activity of dashboardStats.recentActivities" class="activity-item">
            <div class="activity-icon" [class]="'activity-' + activity.type">
              <span class="material-icons">
                {{ activity.type === 'success' ? 'check_circle' : 
                   activity.type === 'warning' ? 'warning' : 
                   activity.type === 'info' ? 'info' : 'circle' }}
              </span>
            </div>
            <div class="activity-content">
              <p class="activity-action">{{ activity.action }}</p>
              <p class="activity-meta">{{ activity.user }} â€¢ {{ activity.time }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-section" *ngIf="dashboardStats.departmentStats.length > 0">
      <div class="section">
        <h2>Department Distribution</h2>
        <div class="chart-container">
          <div class="chart-item" *ngFor="let dept of dashboardStats.departmentStats">
            <div class="chart-bar">
              <div class="bar-fill" [style.width.%]="getDepartmentPercentage(dept.count)"></div>
            </div>
            <div class="chart-label">
              <span class="dept-name">{{ dept.department_name }}</span>
              <span class="dept-count">{{ dept.count }} employees</span>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>Employment Type Distribution</h2>
        <div class="chart-container">
          <div class="chart-item" *ngFor="let empType of dashboardStats.employmentTypeStats">
            <div class="chart-bar">
              <div class="bar-fill" [style.width.%]="getEmploymentTypePercentage(empType.count)"></div>
            </div>
            <div class="chart-label">
              <span class="emp-type-name">{{ formatEmploymentType(empType.employment_type) }}</span>
              <span class="emp-type-count">{{ empType.count }} employees</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
